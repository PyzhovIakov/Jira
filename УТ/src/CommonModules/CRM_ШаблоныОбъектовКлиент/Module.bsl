
////////////////////////////////////////////////////////////////////////////////
// CRM шаблоны объектов клиент
//  
////////////////////////////////////////////////////////////////////////////////

#Область ПрограммныйИнтерфейс

// Процедура помещает команды группы только во все действия.
//
// Параметры:
//  Форма	 - ФормаКлиентскогоПриложения - Передаваемая форма. 
//
Процедура ПоместитьКомандыГруппыТолькоВоВсеДействия(Форма) Экспорт

	Если Форма.Элементы.Найти("ФормаСправочникCRM_ШаблоныОбъектовЗагрузитьИзШаблона") <> Неопределено Тогда
		Форма.Элементы.ФормаСправочникCRM_ШаблоныОбъектовЗагрузитьИзШаблона.ТолькоВоВсехДействиях = Истина;
		Если Не СтрНайти(Форма.ИмяФормы, "ФормаСписка") Тогда
			Форма.Элементы.ФормаСправочникCRM_ШаблоныОбъектовЗагрузитьИзШаблона.Видимость = Ложь;
		Иначе
			Форма.Элементы.ФормаСправочникCRM_ШаблоныОбъектовЗагрузитьИзШаблона.Заголовок = НСтр("ru='Создать из шаблона';
				|en='Create from template'");
		КонецЕсли;
	КонецЕсли;
	Если Форма.Элементы.Найти("ФормаСправочникCRM_ШаблоныОбъектовВыгрузитьВШаблон") <> Неопределено Тогда
		Форма.Элементы.ФормаСправочникCRM_ШаблоныОбъектовВыгрузитьВШаблон.ТолькоВоВсехДействиях = Истина;
	КонецЕсли;

КонецПроцедуры

// Процедура загружает из шаблона на клиенте.
//
// Параметры:
//  сПараметры	 - Структура - Струуктура с параметрами. 
//
Процедура ЗагрузитьИзШаблонаНаКлиенте(сПараметры) Экспорт

	ТекстВопроса = НСтр("ru='Введенные данные могут быть заменены! Продолжить?';
		|en='The entered data could be replaced! Continue?'");
	ОписаниеОповещения = Новый ОписаниеОповещения("ЗагрузитьИзШаблонаНаКлиентеЗавершение", ЭтотОбъект, сПараметры);
	ПоказатьВопрос(ОписаниеОповещения, ТекстВопроса, РежимДиалогаВопрос.ОКОтмена);
	
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

Процедура ЗагрузитьИзШаблонаНаКлиентеЗавершение(Результат, сПараметры) Экспорт

	Если НЕ (Результат = КодВозвратаДиалога.ОК) Тогда
		Возврат;
	КонецЕсли;
		
	СсылкаНаОбъект = сПараметры.Ссылка;
	ПараметрыФормы = Новый Структура;
	ПараметрыФормы.Вставить("РежимВыбора",				Истина);
	ПараметрыФормы.Вставить("МножественныйВыбор",		Ложь);
	ПараметрыФормы.Вставить("ЗакрыватьПриВыборе",		Истина);
	ПараметрыФормы.Вставить("Основание", СсылкаНаОбъект);
	
	ОткрытьФорму("Справочник.CRM_ШаблоныОбъектов.ФормаВыбора", ПараметрыФормы, сПараметры.Форма, , , , ,
		 РежимОткрытияОкнаФормы.БлокироватьОкноВладельца);
	
КонецПроцедуры

#КонецОбласти
