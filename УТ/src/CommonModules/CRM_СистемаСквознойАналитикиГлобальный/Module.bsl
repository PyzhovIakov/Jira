////////////////////////////////////////////////////////////////////////////////
// Система сквозной аналитики (глобальный)
//
////////////////////////////////////////////////////////////////////////////////

#Область СлужебныеПроцедурыИФункции

Процедура са_СообщитьОбОкончанииРучногоВыполненияРегламентногоЗадания() Экспорт
	
	ОповещенияОбОкончанииВыполнения =
		CRM_СистемаСквознойАналитикиКлиент.ОповещенияОбОкончанииВыполненияРегламентныхЗаданий();
	Если ОповещенияОбОкончанииВыполнения.Количество() > 0 Тогда
		Для Каждого Оповещение Из ОповещенияОбОкончанииВыполнения Цикл
			Если ЗначениеЗаполнено(Оповещение.СтрокаОшибки) Тогда
				ПоказатьОповещениеПользователя(
					НСтр("ru='Ошибка выполнения регламентного задания';en='Scheduled job error'"),
					,
					СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
						НСтр("ru='%1.""Ошибка: %2';en='%1.""Error: %2'"),
						Оповещение.ПредставлениеРегламентногоЗадания,
						Оповещение.СтрокаОшибки),
					БиблиотекаКартинок.CRM_НеудачноеЗавершение);

			Иначе	
				ПоказатьОповещениеПользователя(
					НСтр("ru='Выполнено регламентное задание';en='Scheduled job complete'"),
					,
					СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
						НСтр("ru='%1."
"Процедура завершена в фоновом задании %2';en='%1."
"The procedure is completed in background job %2'"),
						Оповещение.ПредставлениеРегламентногоЗадания,
						Строка(Оповещение.МоментОкончания)),
					БиблиотекаКартинок.ВыполнитьРегламентноеЗаданиеВручную);
			КонецЕсли;
		КонецЦикла;
	КонецЕсли;

КонецПроцедуры

#КонецОбласти
