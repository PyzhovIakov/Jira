////////////////////////////////////////////////////////////////////////////////
// Лицензирование сервер (повт. исп)
//
////////////////////////////////////////////////////////////////////////////////

#Область ПрограммныйИнтерфейс

// Функция создает и инициализирует защищенную обработку. В дальнейшем, в течении
//  сеанса, значение будет закешировано, и вызов будет возвращать тот же
//  экземпляр обработки
//  ИмяОбработки - строка с именем защищенной обработки
//  параметра лицензирования будет совпадать или превышать переданную в этом параметре
//  ОписаниеОшибки - возвращаемый параметр, содержит описание результата операции
//
// Параметры:
//  ВыводитьОшибки	 - Булево - Выводить ошибки.
// 
// Возвращаемое значение:
//  ВнешняяОбработка - Созданная обработка.
//
Функция ПолучитьЗащищеннуюОбработку(ВыводитьОшибки = Истина) Экспорт
	
	Возврат CRM_ЛицензированиеЭкспортныеМетоды.ПолучитьЗащищеннуюОбработкуКеш(ВыводитьОшибки, Ложь);
	
КонецФункции // ПолучитьЗащищеннуюОбработку    

// Функция создает и инициализирует защищенную обработку. В дальнейшем, в течении
//  сеанса, значение будет закешировано, и вызов будет возвращать тот же
//  экземпляр обработки
//  ИмяОбработки - строка с именем защищенной обработки
//  параметра лицензирования будет совпадать или превышать переданную в этом параметре
//  ОписаниеОшибки - возвращаемый параметр, содержит описание результата операции
//
// Параметры:
//  ВыводитьОшибки	 - Булево - Выводить ошибки.
// 
// Возвращаемое значение:
//  ВнешняяОбработка - Созданная обработка.
//
Функция ПолучитьЗащищеннуюОбработкуМоб(ВыводитьОшибки = Истина) Экспорт
	
	Возврат CRM_ЛицензированиеЭкспортныеМетоды.ПолучитьЗащищеннуюОбработкуКеш(ВыводитьОшибки, Истина);
	
КонецФункции // ПолучитьЗащищеннуюОбработку

// Функция возвращает серию ключей текущего варианта поставки
// Параметры:
//  ВариантПоставки - ПеречислениеСсылка.CRM_ВариантыПоставки - вариант поставки
// 
// Возвращаемое значение:
//  Строка - серия ключа
//
Функция ПолучитьСериюКлюча(ВариантПоставки) Экспорт
	
	Если ВариантПоставки = Перечисления.CRM_ВариантыПоставки.СТАРТ Тогда
		СерияКлюча = Метаданные.ОбщиеМакеты.CRM_ФайлДанныхОРСР_СТАРТ.Комментарий;
		
	ИначеЕсли ВариантПоставки = Перечисления.CRM_ВариантыПоставки.ПРОФ Тогда
		СерияКлюча = Метаданные.ОбщиеМакеты.CRM_ФайлДанныхОРСР_ПРОФ.Комментарий;
		
	ИначеЕсли ВариантПоставки = Перечисления.CRM_ВариантыПоставки.КОРП Тогда
		СерияКлюча = Метаданные.ОбщиеМакеты.CRM_ФайлДанныхОРСР_КОРП.Комментарий;
		
	ИначеЕсли ВариантПоставки = Перечисления.CRM_ВариантыПоставки.БАЗОВАЯ Тогда
		СерияКлюча = Метаданные.ОбщиеМакеты.CRM_ФайлДанныхОРСР_БАЗОВАЯ.Комментарий;
	
	ИначеЕсли ВариантПоставки = Перечисления.CRM_ВариантыПоставки.СТАНДАРТ Тогда
		СерияКлюча = Метаданные.ОбщиеМакеты.CRM_ФайлДанныхОРСР_СТАНДАРТ.Комментарий;
	
	Иначе
		СерияКлюча = "";
	КонецЕсли;
	
	Возврат СерияКлюча;
	
КонецФункции // ПолучитьСериюКлюча

#КонецОбласти
