// @strict-types

#Область СлужебныйПрограммныйИнтерфейс

// Параметры:
//  ПодписанныйОбъект - СправочникСсылка.СообщениеЭДОПрисоединенныеФайлы
//  ПорядковыйНомерПодписи - Число
// 
// Возвращаемое значение:
//  Структура:
// * СообщениеЭДО - ДокументСсылка.СообщениеЭДО 
// * ДанныеПодписи - Неопределено
//                 - См. ЭлектронныеДокументыЭДОКлиентСервер.НовыеДанныеПодписиСУчетомДоверенности
Функция ДанныеПодписиОбъектаДляОткрытияРезультатаПроверки(Знач ПодписанныйОбъект, Знач ПорядковыйНомерПодписи) Экспорт

	Результат = Новый Структура("СообщениеЭДО, ДанныеПодписи", Документы.СообщениеЭДО.ПустаяСсылка(), Неопределено);
	
	Результат.СообщениеЭДО = ОбщегоНазначения.ЗначениеРеквизитаОбъекта(ПодписанныйОбъект, "ВладелецФайла");
	
	ПодписиОбъекта = ЭлектронныеДокументыЭДО.УстановленныеПодписиФайлаСУчетомДоверенностей(
		ПодписанныйОбъект, ПорядковыйНомерПодписи);
		
	Если ПодписиОбъекта.Количество() Тогда
		Результат.ДанныеПодписи = ПодписиОбъекта[0];
		ИнтерфейсДокументовЭДО.СкорректироватьДатыПодписиНаЧасовойПоясКлиента(Результат.ДанныеПодписи);
	КонецЕсли;

	Возврат Результат;

КонецФункции

// Параметры:
//  ЭлектронныйДокумент - ДокументСсылка.ЭлектронныйДокументИсходящийЭДО,ДокументСсылка.ЭлектронныйДокументВходящийЭДО
//  ИдентификаторФормы - УникальныйИдентификатор
//  ЭтоОблачныйЭДО - Булево
//
// Возвращаемое значение:
//  См. ДлительныеОперации.ВыполнитьФункцию
Функция ДанныеФайлаИнформацииОтправителяДокумента(Знач ЭлектронныйДокумент, Знач ИдентификаторФормы,
	Знач ЭтоОблачныйЭДО) Экспорт
	
	ПараметрыВыполненияВФоне = ДлительныеОперации.ПараметрыВыполненияФункции(ИдентификаторФормы);
	
	Возврат ДлительныеОперации.ВыполнитьФункцию(ПараметрыВыполненияВФоне,
		"ЛегкийИнтерфейсДокументовЭДО.ДанныеФайлаИнформацииОтправителяДокументаПоИнтеграциям", // См. ЛегкийИнтерфейсДокументовЭДО.ДанныеФайлаИнформацииОтправителяДокументаПоИнтеграциям
		ЭлектронныйДокумент, ИдентификаторФормы, ЭтоОблачныйЭДО);

КонецФункции

#Область ОтражениеВУчете

// Параметры:
//  СпособОбработки - Строка - один из способов обработки входящего электронного документа.
// 
// Возвращаемое значение:
//  - Неопределено
//  - Структура:
//    * ИмяОбъектаМетаданных - Строка
//    * ИмяТипаСсылки - Строка
Функция ПараметрыОбъектаУчетаПоСпособуОбработки(Знач СпособОбработки) Экспорт
	
	Параметры = Новый Структура;
	Параметры.Вставить("ИмяОбъектаМетаданных", "");
	Параметры.Вставить("ИмяТипаСсылки", "");
	
	ИмяТипа = ИнтеграцияЭДО.ИмяДокументаПоСпособуОбработки(СпособОбработки);
	
	МетаданныеОбъектаДокумент = Метаданные.Документы.Найти(ИмяТипа);
	Если МетаданныеОбъектаДокумент <> Неопределено Тогда
		Параметры.ИмяОбъектаМетаданных = МетаданныеОбъектаДокумент.ПолноеИмя();
		Параметры.ИмяТипаСсылки = "ДокументСсылка." + ИмяТипа;
		Возврат Параметры;
	КонецЕсли;
	
	МетаданныеОбъектаСправочник = Метаданные.Справочники.Найти(ИмяТипа);
	Если МетаданныеОбъектаСправочник <> Неопределено Тогда
		Параметры.ИмяОбъектаМетаданных = МетаданныеОбъектаСправочник.ПолноеИмя();
		Параметры.ИмяТипаСсылки = "СправочникСсылка." + ИмяТипа;
		Возврат Параметры;
	КонецЕсли;
	
	Возврат Неопределено;
	
КонецФункции

#КонецОбласти // ОтражениеВУчете

#КонецОбласти
