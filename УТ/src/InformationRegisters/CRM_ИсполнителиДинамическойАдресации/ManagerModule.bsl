// BSLLS:ForbiddenMetadataName-off
#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ПрограммныйИнтерфейс

// Записывает в регистр исолнителей задачи
//
// Параметры:
//  Задача  - ЗадачаСсылка.ЗадачаИсполнителя - Ссылка на задачу, для которой определяются исполнители.
//  Исполнители  - Массив исполнителей задачи.
//  
Процедура ЗаписатьИсполнителейДинамическойАдресации(Задача, Исполнители) Экспорт
	
	УстановитьПривилегированныйРежим(Истина);
	
	Набор = СоздатьНаборЗаписей();
	Набор.Отбор.Задача.Установить(Задача);
	Набор.Прочитать();
	Набор.Очистить();
	Для каждого Исполнитель Из Исполнители Цикл
		НовЗапись = Набор.Добавить();
		НовЗапись.Задача = Задача;
		НовЗапись.Исполнитель = Исполнитель;
	КонецЦикла;
	Набор.Записать();
	
КонецПроцедуры

// Возвращает исолнителей задачи
//
// Параметры:
//  Задача  - ЗадачаСсылка.ЗадачаИсполнителя - Ссылка на задачу, для которой определяются исполнители.
//
// Возвращаемое значение:
//	Массив - исполнители задачи.	
//  
Функция ИсполнителиЗадачи(Задача) Экспорт
	Запрос = Новый Запрос("ВЫБРАТЬ
	                      |	CRM_ИсполнителиДинамическойАдресации.Исполнитель КАК Исполнитель
	                      |ИЗ
	                      |	РегистрСведений.CRM_ИсполнителиДинамическойАдресации КАК CRM_ИсполнителиДинамическойАдресации
	                      |ГДЕ
	                      |	CRM_ИсполнителиДинамическойАдресации.Задача = &Задача");
	Запрос.УстановитьПараметр("Задача", Задача);
	Возврат Запрос.Выполнить().Выгрузить().ВыгрузитьКолонку("Исполнитель");
КонецФункции

#КонецОбласти

#КонецЕсли
