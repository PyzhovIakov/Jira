#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область СлужебныйПрограммныйИнтерфейс

Функция СледующийИсполнитель(Очередь) Экспорт
	
	ИсполнителейВОчереди = Очередь.ОчередьОтветственных.Количество();
	Если ИсполнителейВОчереди = 0 Тогда
		Возврат Неопределено;
	КонецЕсли;
	
	Выборка = Выбрать(Новый Структура("Очередь", Очередь));
	Если Выборка.Следующий() Тогда
		НомерИсполнителя = Выборка.НомерСледующего;
	Иначе
		НомерИсполнителя = 1;
	КонецЕсли;
	
	Если НомерИсполнителя > Очередь.ОчередьОтветственных.Количество() Тогда
		НомерИсполнителя = 1;
	КонецЕсли;
	
	НомерСледующего = НомерИсполнителя + 1;
	Если НомерСледующего > ИсполнителейВОчереди Тогда
		НомерСледующего = 1;
	КонецЕсли;
	
	Запись = СоздатьМенеджерЗаписи();
	Запись.Очередь = Очередь;
	Запись.НомерСледующего = НомерСледующего;
	Запись.Записать();
	
	Возврат Очередь.ОчередьОтветственных[НомерИсполнителя - 1].Ответственный;
	
КонецФункции

#КонецОбласти
	
#КонецЕсли
