// @strict-types


#Область ОбработчикиСобытийФормы

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	ОтборПоУчетнойЗаписи = ОбщегоНазначенияКлиентСервер.СвойствоСтруктуры(
		Параметры.Отбор, "УчетнаяЗаписьОблачногоЭДО"); // СправочникСсылка.УчетныеЗаписиОблачногоЭДО
	Если ЗначениеЗаполнено(ОтборПоУчетнойЗаписи) Тогда
		УчетнаяЗаписьОблачногоЭДО = ОтборПоУчетнойЗаписи;
		Элементы.УчетнаяЗаписьОблачногоЭДО.Видимость = Ложь;
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти

#Область ОбработчикиСобытийЭлементовТаблицыФормыСписок

&НаКлиенте
Процедура СписокПередНачаломДобавления(Элемент, Отказ, Копирование, Родитель, ЭтоГруппа, Параметр)
	
	Отказ = Истина;
	
	ТекущиеДанные = Элемент.ТекущиеДанные;
	
	ПараметрыПодключения = ИнтеграцияОблачногоЭДОКлиент.НовыеПараметрыПодключенияОблачногоЭДО();
	ПараметрыПодключения.НовоеПодключение = Ложь;
	
	Если ЗначениеЗаполнено(УчетнаяЗаписьОблачногоЭДО) Тогда
		ПараметрыПодключения.УчетнаяЗапись = УчетнаяЗаписьОблачногоЭДО;
	ИначеЕсли Копирование Тогда 
		ПараметрыПодключения.УчетнаяЗапись = ТекущиеДанные.УчетнаяЗаписьОблачногоЭДО;
	КонецЕсли;
	
	Если Копирование Тогда
		ПараметрыПодключения.Логин = ТекущиеДанные.Логин;
	КонецЕсли;
	
	ИнтеграцияОблачногоЭДОКлиент.ПодключитьОблачныйЭДО(,ПараметрыПодключения);
	
КонецПроцедуры

#КонецОбласти
