#Область ОбработчикиСобытий

&НаКлиенте
Процедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)
	
	ОписаниеОповещения = Новый ОписаниеОповещения("ОбработкаКомандыЗавершение", ЭтотОбъект);
	ПоказатьВопрос(ОписаниеОповещения, НСтр("ru = 'Завершить?'"), РежимДиалогаВопрос.ДаНет);
	
КонецПроцедуры

&НаКлиенте
Процедура ОбработкаКомандыЗавершение(Ответ, ДопПараметры) Экспорт
	
	Если Ответ <> КодВозвратаДиалога.Да Тогда
		Возврат;
	КонецЕсли;
	CRM_МетодыМодулейМенеджеровРегистров.ЗавершитьОтсутствиеТекущегоПользователя();
	//CRM_РабочийСтолКлиент.ПереинициализироватьРабочийСтолКлиент();
	Если ск_глСтекФормРабочегоСтола <> Неопределено Тогда
		Для Каждого Элемент Из ск_глСтекФормРабочегоСтола Цикл
			Если Элемент.Значение.Открыта() Тогда
				Элемент = Элемент.Значение.Элементы.Найти("скНадписьОтсутствиеПользователя");
				Если Элемент <> Неопределено Тогда
					Элемент.Видимость = Ложь;
				КонецЕсли;
			КонецЕсли;	
		КонецЦикла;
	КонецЕсли;
	Оповестить("ЗавершениеОтсутствияПользователя");
	
КонецПроцедуры

#КонецОбласти
